code from jack
updated code

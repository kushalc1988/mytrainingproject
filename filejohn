code from John

again updated code
=======
code update from John again

updated code
